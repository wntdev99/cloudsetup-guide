# Elasticsearch ì¸ë±ì‹± ë° ê²€ìƒ‰í•˜ê¸°

ì´ì œ Elasticsearchì— **ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³  ì „ë¬¸ê²€ìƒ‰ì„ ìˆ˜í–‰**í•˜ëŠ” ë°©ë²•ì„ ë°°ì›ë‹ˆë‹¤. ì‹¤ì „ ì˜ˆì œë¡œ ë¬¸ì„œë¥¼ ì¸ë±ì‹±í•˜ê³  ê²€ìƒ‰ ì¿¼ë¦¬ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.

<FreeTierInfo
  service="Elasticsearch"
  limit="ë¬´ì œí•œ ì¸ë±ì‹± ë° ê²€ìƒ‰"
  period="unlimited"
  status="generous"
/>

## ì‹œì‘í•˜ê¸° ì „ì—

<PrerequisiteCheck items={[
  { text: "Elasticsearch ì„¤ì¹˜ë¨", required: true },
  { text: "Elasticsearch ì„œë²„ ì‹¤í–‰ ì¤‘", required: true },
  { text: "curl ë˜ëŠ” API í´ë¼ì´ì–¸íŠ¸ (Postman, Thunder Client)", required: true },
  { text: "ê¸°ë³¸ì ì¸ JSON ë¬¸ë²• ì´í•´", required: false }
]} />

<Callout type="info">
ğŸ“š **ì¸ë±ì‹±ì´ë€?** ì¸ë±ì‹±ì€ ë°ì´í„°ë² ì´ìŠ¤ì— ë¬¸ì„œë¥¼ ì €ì¥í•˜ëŠ” ê³¼ì •ì…ë‹ˆë‹¤. ElasticsearchëŠ” JSON í˜•ì‹ì˜ ë¬¸ì„œë¥¼ ì €ì¥í•˜ê³  ë¹ ë¥´ê²Œ ê²€ìƒ‰í•˜ê¸° ìœ„í•´ ì—­ ì¸ë±ìŠ¤[inverted index]ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
</Callout>

---

<Step number={1} title="ì¸ë±ìŠ¤ ìƒì„±í•˜ê¸°">

ì¸ë±ìŠ¤ëŠ” Elasticsearchì˜ **ë°ì´í„°ë² ì´ìŠ¤**ì²˜ëŸ¼ ì‘ë™í•©ë‹ˆë‹¤. ë¬¸ì„œë“¤ì„ ì €ì¥í•˜ëŠ” ê³µê°„ì…ë‹ˆë‹¤.

### ê¸°ë³¸ ì¸ë±ìŠ¤ ìƒì„±

<CopyBlock language="bash" title="ì¸ë±ìŠ¤ ìƒì„±">
curl -X PUT http://localhost:9200/products
</CopyBlock>

ì‘ë‹µ:
```json
{
  "acknowledged": true,
  "shards_acknowledged": true,
  "index": "products"
}
```

### ì„¤ì •ì„ í¬í•¨í•œ ì¸ë±ìŠ¤ ìƒì„±

ë” ìì„¸í•œ ì„¤ì •ê³¼ í•¨ê»˜:

<CopyBlock language="bash" title="ë§¤í•‘ ì •ë³´ë¥¼ í¬í•¨í•œ ì¸ë±ìŠ¤ ìƒì„±">
curl -X PUT http://localhost:9200/articles \
  -H "Content-Type: application/json" \
  -d '{
    "mappings": {
      "properties": {
        "title": { "type": "text" },
        "content": { "type": "text" },
        "author": { "type": "keyword" },
        "published_date": { "type": "date" },
        "tags": { "type": "keyword" }
      }
    }
  }'
</CopyBlock>

<Screenshot
  src="https://res.cloudinary.com/demo/image/upload/v1/elasticsearch/step1-create-index-ko.png"
  alt="ì¸ë±ìŠ¤ ìƒì„±"
  caption="curlë¡œ Elasticsearch ì¸ë±ìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤"
  priority={true}
/>

<Callout type="tip">
ğŸ’¡ **í•„ë“œ íƒ€ì…**: `text`ëŠ” ì „ë¬¸ê²€ìƒ‰ìš© (ë‹¨ì–´ ë¶„ì„), `keyword`ëŠ” ì •í™•í•œ ì¼ì¹˜ìš©ì…ë‹ˆë‹¤.
</Callout>

<Checkpoint>
ì¸ë±ìŠ¤ ìƒì„± ì‘ë‹µì—ì„œ "acknowledged": trueê°€ ë³´ì´ë‚˜ìš”?
</Checkpoint>

</Step>

---

<Step number={2} title="ë¬¸ì„œ ì¸ë±ì‹±í•˜ê¸°">

ì¸ë±ìŠ¤ì— ë¬¸ì„œ[documents]ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.

### ë‹¨ì¼ ë¬¸ì„œ ì¶”ê°€

<CopyBlock language="bash" title="ë¬¸ì„œ ì¶”ê°€">
curl -X POST http://localhost:9200/products/_doc \
  -H "Content-Type: application/json" \
  -d '{
    "name": "ë…¸íŠ¸ë¶",
    "price": 1200000,
    "category": "ì „ìì œí’ˆ",
    "in_stock": true,
    "description": "ê³ ì„±ëŠ¥ ë…¸íŠ¸ë¶, 8ì½”ì–´ í”„ë¡œì„¸ì„œ, 16GB RAM"
  }'
</CopyBlock>

ì‘ë‹µì—ì„œ ìƒì„±ëœ IDë¥¼ í™•ì¸í•©ë‹ˆë‹¤:
```json
{
  "_index": "products",
  "_type": "_doc",
  "_id": "abc123",
  "_version": 1,
  "result": "created"
}
```

### ì—¬ëŸ¬ ë¬¸ì„œ í•œë²ˆì— ì¶”ê°€ (ë²Œí¬ ì¸ë±ì‹±)

ëŒ€ëŸ‰ì˜ ë¬¸ì„œë¥¼ ë¹ ë¥´ê²Œ ì¶”ê°€í•  ë•Œ:

<CopyBlock language="bash" title="ë²Œí¬ ì¸ë±ì‹±">
curl -X POST http://localhost:9200/products/_bulk \
  -H "Content-Type: application/json" \
  -d '{
    "index": {}
  }
  {
    "name": "ë§ˆìš°ìŠ¤",
    "price": 50000,
    "category": "ì•¡ì„¸ì„œë¦¬"
  }
  {
    "index": {}
  }
  {
    "name": "í‚¤ë³´ë“œ",
    "price": 150000,
    "category": "ì•¡ì„¸ì„œë¦¬"
  }
  {
    "index": {}
  }
  {
    "name": "ëª¨ë‹ˆí„°",
    "price": 350000,
    "category": "ì „ìì œí’ˆ"
  }
  '
</CopyBlock>

<Screenshot
  src="https://res.cloudinary.com/demo/image/upload/v1/elasticsearch/step2-index-documents-ko.png"
  alt="ë¬¸ì„œ ì¸ë±ì‹±"
  caption="JSON ë¬¸ì„œë¥¼ Elasticsearchì— ì¶”ê°€í•©ë‹ˆë‹¤"
/>

<DevTip>
ë²Œí¬ ì¸ë±ì‹±ì€ ëŒ€ëŸ‰ ë°ì´í„° ì‚½ì… ì‹œ í›¨ì”¬ ë¹ ë¦…ë‹ˆë‹¤. ë§¤ë²ˆ í•œ ë¬¸ì„œì”© ì¶”ê°€í•˜ëŠ” ê²ƒë³´ë‹¤ ìˆ˜ë°±ë°° ë¹ ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
</DevTip>

<Checkpoint>
ë¬¸ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆë‚˜ìš”? _id ê°’ì´ ë°˜í™˜ë˜ì—ˆë‚˜ìš”?
</Checkpoint>

</Step>

---

<Step number={3} title="ê²€ìƒ‰ ì¿¼ë¦¬ ì‘ì„±í•˜ê¸°">

### ë§¤ì¹˜ ì¿¼ë¦¬ (ì „ë¬¸ê²€ìƒ‰)

íŠ¹ì • ë‹¨ì–´ë¥¼ í¬í•¨í•˜ëŠ” ë¬¸ì„œë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤:

<CopyBlock language="bash" title="ë§¤ì¹˜ ì¿¼ë¦¬ë¡œ ê²€ìƒ‰">
curl -X GET http://localhost:9200/products/_search \
  -H "Content-Type: application/json" \
  -d '{
    "query": {
      "match": {
        "description": "í”„ë¡œì„¸ì„œ"
      }
    }
  }'
</CopyBlock>

### ìš©ì–´ ì¿¼ë¦¬ (ì •í™• ì¼ì¹˜)

ì •í™•í•œ ê°’ì„ ê²€ìƒ‰í•©ë‹ˆë‹¤:

<CopyBlock language="bash" title="ìš©ì–´ ì¿¼ë¦¬ë¡œ ê²€ìƒ‰">
curl -X GET http://localhost:9200/products/_search \
  -H "Content-Type: application/json" \
  -d '{
    "query": {
      "term": {
        "category": "ì•¡ì„¸ì„œë¦¬"
      }
    }
  }'
</CopyBlock>

### ë²”ìœ„ ì¿¼ë¦¬ (ë¶€ë“±í˜¸)

ê°€ê²©ì´ 100,000ì› ì´ìƒ 500,000ì› ì´í•˜ì¸ ì œí’ˆ ê²€ìƒ‰:

<CopyBlock language="bash" title="ë²”ìœ„ ì¿¼ë¦¬">
curl -X GET http://localhost:9200/products/_search \
  -H "Content-Type: application/json" \
  -d '{
    "query": {
      "range": {
        "price": {
          "gte": 100000,
          "lte": 500000
        }
      }
    }
  }'
</CopyBlock>

### Bool ì¿¼ë¦¬ (ë³µí•© ì¡°ê±´)

ì—¬ëŸ¬ ì¡°ê±´ì„ í•¨ê»˜ ì‚¬ìš©:

<CopyBlock language="bash" title="Bool ì¿¼ë¦¬">
curl -X GET http://localhost:9200/products/_search \
  -H "Content-Type: application/json" \
  -d '{
    "query": {
      "bool": {
        "must": [
          { "match": { "category": "ì „ìì œí’ˆ" } }
        ],
        "filter": [
          { "range": { "price": { "gte": 1000000 } } }
        ]
      }
    }
  }'
</CopyBlock>

<Screenshot
  src="https://res.cloudinary.com/demo/image/upload/v1/elasticsearch/step3-search-queries-ko.png"
  alt="ê²€ìƒ‰ ì¿¼ë¦¬"
  caption="ë‹¤ì–‘í•œ ì¿¼ë¦¬ íƒ€ì…ìœ¼ë¡œ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤"
/>

<Checkpoint>
ê²€ìƒ‰ ê²°ê³¼ê°€ ë‚˜ì˜¤ë‚˜ìš”? hits ë°°ì—´ì— ë¬¸ì„œë“¤ì´ í¬í•¨ë˜ì–´ ìˆë‚˜ìš”?
</Checkpoint>

</Step>

---

<Step number={4} title="ê²€ìƒ‰ ê²°ê³¼ ì •ë ¬ ë° í•„í„°ë§">

### ê²°ê³¼ ì •ë ¬

ê°€ê²©ìˆœìœ¼ë¡œ ì •ë ¬í•˜ì—¬ ê²€ìƒ‰:

<CopyBlock language="bash" title="ê°€ê²©ìˆœ ì •ë ¬">
curl -X GET http://localhost:9200/products/_search \
  -H "Content-Type: application/json" \
  -d '{
    "query": { "match_all": {} },
    "sort": [
      { "price": { "order": "desc" } }
    ]
  }'
</CopyBlock>

### í˜ì´ì§€ë„¤ì´ì…˜

fromê³¼ sizeë¡œ ê²°ê³¼ë¥¼ í˜ì´ì§€ ë‹¨ìœ„ë¡œ ë‚˜ëˆ•ë‹ˆë‹¤:

<CopyBlock language="bash" title="í˜ì´ì§€ë„¤ì´ì…˜">
curl -X GET http://localhost:9200/products/_search \
  -H "Content-Type: application/json" \
  -d '{
    "query": { "match_all": {} },
    "from": 0,
    "size": 10
  }'
</CopyBlock>

### íŠ¹ì • í•„ë“œë§Œ ë°˜í™˜

ë¶ˆí•„ìš”í•œ í•„ë“œëŠ” ì œì™¸í•˜ê³  í•„ìš”í•œ í•„ë“œë§Œ ë°˜í™˜:

<CopyBlock language="bash" title="íŠ¹ì • í•„ë“œë§Œ ì„ íƒ">
curl -X GET http://localhost:9200/products/_search \
  -H "Content-Type: application/json" \
  -d '{
    "query": { "match_all": {} },
    "_source": ["name", "price", "category"]
  }'
</CopyBlock>

<Screenshot
  src="https://res.cloudinary.com/demo/image/upload/v1/elasticsearch/step4-sorting-ko.png"
  alt="ì •ë ¬ ë° í•„í„°ë§"
  caption="ì •ë ¬, í˜ì´ì§€ë„¤ì´ì…˜, í•„ë“œ ì„ íƒìœ¼ë¡œ ê²°ê³¼ë¥¼ ìµœì í™”í•©ë‹ˆë‹¤"
/>

</Step>

---

<Step number={5} title="ì§‘ê³„ ë° ë¶„ì„">

### ì¹´í…Œê³ ë¦¬ë³„ ë¬¸ì„œ ìˆ˜ ê³„ì‚°

<CopyBlock language="bash" title="ì§‘ê³„ ì¿¼ë¦¬">
curl -X GET http://localhost:9200/products/_search \
  -H "Content-Type: application/json" \
  -d '{
    "aggs": {
      "category_counts": {
        "terms": {
          "field": "category"
        }
      }
    }
  }'
</CopyBlock>

ì‘ë‹µ:
```json
{
  "aggregations": {
    "category_counts": {
      "buckets": [
        {
          "key": "ì „ìì œí’ˆ",
          "doc_count": 2
        },
        {
          "key": "ì•¡ì„¸ì„œë¦¬",
          "doc_count": 3
        }
      ]
    }
  }
}
```

### í‰ê·  ê°€ê²© ê³„ì‚°

<CopyBlock language="bash" title="í‰ê·  ê³„ì‚°">
curl -X GET http://localhost:9200/products/_search \
  -H "Content-Type: application/json" \
  -d '{
    "aggs": {
      "avg_price": {
        "avg": {
          "field": "price"
        }
      }
    }
  }'
</CopyBlock>

<Callout type="success">
âœ… **ì¶•í•˜í•©ë‹ˆë‹¤!** ì´ì œ Elasticsearchì—ì„œ ë°ì´í„°ë¥¼ ì¸ë±ì‹±í•˜ê³  ê²€ìƒ‰í•˜ëŠ” ë°©ë²•ì„ ì•Œê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.
</Callout>

<Screenshot
  src="https://res.cloudinary.com/demo/image/upload/v1/elasticsearch/step5-aggregations-ko.png"
  alt="ì§‘ê³„"
  caption="ì§‘ê³„ë¡œ ë°ì´í„°ì˜ í†µê³„ ì •ë³´ë¥¼ ì–»ìŠµë‹ˆë‹¤"
/>

</Step>

---

## ì‹¤ì „ íŒ

### ì¸ë±ìŠ¤ ì •ë³´ í™•ì¸

<CopyBlock language="bash" title="ì¸ë±ìŠ¤ ë§¤í•‘ í™•ì¸">
curl http://localhost:9200/products/_mapping
</CopyBlock>

### ì¸ë±ìŠ¤ ì‚­ì œ

<CopyBlock language="bash" title="ì¸ë±ìŠ¤ ì‚­ì œ">
curl -X DELETE http://localhost:9200/products
</CopyBlock>

### ëª¨ë“  ì¸ë±ìŠ¤ í™•ì¸

<CopyBlock language="bash" title="ì¸ë±ìŠ¤ ëª©ë¡">
curl http://localhost:9200/_cat/indices
</CopyBlock>

---

## ë¬¸ì œ í•´ê²°

### ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤

1. ì¸ë±ìŠ¤ì— ë¬¸ì„œê°€ ìˆëŠ”ì§€ í™•ì¸:
   ```bash
   curl http://localhost:9200/products/_count
   ```

2. ë§¤í•‘ í™•ì¸ - í•„ë“œ íƒ€ì…ì´ ì˜¬ë°”ë¥¸ì§€ í™•ì¸í•©ë‹ˆë‹¤

3. ì¿¼ë¦¬ ë¬¸ë²• í™•ì¸ - JSONì´ ìœ íš¨í•œì§€ í™•ì¸í•©ë‹ˆë‹¤

### ì„±ëŠ¥ì´ ëŠë¦½ë‹ˆë‹¤

1. ì¸ë±ìŠ¤ ì„¤ì • ìµœì í™”
2. ë¶ˆí•„ìš”í•œ í•„ë“œëŠ” ì œì™¸
3. ì¿¼ë¦¬ ìºì‹± í™œìš©
4. ìƒ¤ë“œ ê°œìˆ˜ ì¡°ì •
