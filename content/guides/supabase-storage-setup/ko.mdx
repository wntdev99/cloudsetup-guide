---
title: "Supabase 스토리지 설정 가이드 - 파일 업로드 및 CDN"
description: "Supabase Storage에서 버킷을 생성하고 파일을 업로드하며, Row Level Security 정책을 설정하는 방법을 배웁니다."
---

# Supabase 스토리지 설정 가이드

Supabase Storage는 S3 호환 객체 스토리지로, 이미지, 동영상, 문서 등 모든 종류의 파일을 저장하고 관리할 수 있습니다. Row Level Security를 지원하여 파일 접근을 세밀하게 제어할 수 있으며, 내장 CDN과 이미지 변환 기능도 제공합니다.

<FreeTierInfo
  limit="1GB file storage, 2GB bandwidth"
  period="month"
  status="available"
/>

## 시작하기 전에

다음 항목들이 준비되어 있는지 확인하세요.

- [Supabase 계정 및 프로젝트 생성](../supabase-account-setup) 완료
- 업로드할 샘플 파일 (이미지, 문서 등)
- 기본적인 JavaScript/TypeScript 지식

<Callout type="info">
Supabase Storage는 AWS S3와 호환되는 API를 제공하므로, S3를 사용하던 애플리케이션에서 쉽게 마이그레이션할 수 있습니다. TUS 프로토콜을 지원하여 대용량 파일의 재개 가능한 업로드도 가능합니다.
</Callout>

<Step number={1} title="버킷(Bucket) 생성하기">

버킷은 파일을 저장하는 최상위 컨테이너입니다. 용도별로 여러 버킷을 만들 수 있습니다.

1. Supabase 대시보드에서 **Storage**를 클릭합니다
2. **New bucket** 버튼을 클릭합니다
3. 버킷 정보를 입력합니다:

   **Name**: `avatars` (버킷 이름, 소문자와 하이픈만 사용)
   - 예시: `avatars`, `product-images`, `user-documents`

   **Public bucket**: 체크 여부 선택
   - **체크 시 (Public)**: 누구나 파일 URL로 접근 가능 (프로필 사진, 제품 이미지 등)
   - **체크 안 함 (Private)**: RLS 정책에 따라 접근 제어 (개인 문서, 민감한 파일 등)

4. **Create bucket** 버튼을 클릭합니다

<Screenshot
  src="https://res.cloudinary.com/demo/image/upload/v1234567890/guides/supabase-storage-setup/step1-create-bucket-ko.png"
  alt="버킷 생성"
  caption="Supabase Storage에서 새 버킷을 생성합니다"
/>

<DevTip title="Public vs Private 버킷 선택 가이드">
**Public 버킷 (공개):**
- 사용 사례: 프로필 사진, 블로그 이미지, 제품 사진, 공개 문서
- 장점: 별도의 인증 없이 URL로 직접 접근 가능
- 단점: 파일 URL을 아는 사람은 누구나 접근 가능
- URL 예시: `https://project.supabase.co/storage/v1/object/public/avatars/user1.jpg`

**Private 버킷 (비공개):**
- 사용 사례: 개인 문서, 송장, 의료 기록, 회원 전용 콘텐츠
- 장점: RLS 정책으로 세밀한 접근 제어
- 단점: 파일 접근 시 서명된 URL 또는 인증 토큰 필요
- URL 예시: `https://project.supabase.co/storage/v1/object/sign/documents/invoice.pdf?token=xxx`

**추천:**
- 기본적으로 Private 버킷 사용 (보안 우선)
- 정말 공개가 필요한 경우만 Public 버킷 사용
- Public 버킷에도 RLS 정책 적용 가능 (업로드/삭제 제한)
</DevTip>

### 추가 버킷 생성 (선택사항)

용도별로 여러 버킷을 만들 수 있습니다:

- `avatars` (Public): 프로필 사진
- `documents` (Private): 개인 문서
- `product-images` (Public): 상품 이미지
- `thumbnails` (Public): 썸네일 이미지

<Checkpoint>
- [ ] Storage 메뉴 접근 완료
- [ ] 버킷 이름 입력 완료
- [ ] Public/Private 옵션 선택 완료
- [ ] 버킷 생성 완료
</Checkpoint>

</Step>

<Step number={2} title="파일 업로드하기 (GUI)">

대시보드에서 직접 파일을 업로드해봅시다.

1. 생성한 `avatars` 버킷을 클릭합니다
2. **Upload file** 버튼을 클릭합니다
3. 업로드할 파일을 선택합니다
   - 지원 형식: 모든 파일 형식 (이미지, 동영상, PDF, ZIP 등)
   - 최대 크기: 50MB (무료 티어), 5GB (Pro 티어)
4. 파일이 업로드되면 목록에 표시됩니다

<Screenshot
  src="https://res.cloudinary.com/demo/image/upload/v1234567890/guides/supabase-storage-setup/step2-upload-file-ko.png"
  alt="파일 업로드"
  caption="Storage 대시보드에서 파일을 업로드합니다"
/>

### 폴더 구조 만들기

파일을 폴더별로 정리할 수 있습니다:

1. **Create folder** 버튼을 클릭합니다
2. 폴더 이름을 입력합니다 (예: `public`, `users`, `2024`)
3. 폴더를 클릭하여 들어간 후 파일을 업로드합니다

**권장 폴더 구조:**
```
avatars/
├── public/           # 공개 기본 아바타
├── users/
│   ├── user-123/     # 사용자 ID별 폴더
│   └── user-456/
└── thumbnails/       # 썸네일 이미지
```

### 업로드된 파일 URL 확인

1. 업로드된 파일을 클릭합니다
2. **Get URL** 버튼을 클릭합니다
3. 파일 URL이 클립보드에 복사됩니다

**Public 버킷의 URL 형식:**
```
https://your-project-ref.supabase.co/storage/v1/object/public/avatars/user1.jpg
```

**Private 버킷의 URL 형식:**
```
https://your-project-ref.supabase.co/storage/v1/object/sign/documents/file.pdf?token=xxx&exp=1234567890
```

<DevTip title="파일 경로 및 이름 규칙">
**권장 규칙:**
- 소문자 사용
- 공백 대신 하이픈 또는 언더스코어
- 파일 확장자 포함
- UUID 또는 타임스탬프로 고유성 보장

**좋은 예시:**
```
users/123e4567-e89b-12d3-a456-426614174000/profile.jpg
products/smartphone-galaxy-s24.png
documents/2024/01/invoice-2024-01-15.pdf
```

**나쁜 예시:**
```
User Profile.JPG                    # 공백, 대문자
file (1).pdf                        # 괄호, 공백
이미지.png                          # 비ASCII 문자 (권장하지 않음)
```

**파일 이름 충돌 방지:**
```javascript
// UUID 사용
import { v4 as uuidv4 } from 'uuid'
const fileName = \`\${uuidv4()}.jpg\`  // "123e4567-e89b-12d3-a456-426614174000.jpg"

// 타임스탬프 사용
const fileName = \`\${Date.now()}-profile.jpg\`  // "1706423456789-profile.jpg"

// 사용자 ID + 타임스탬프
const fileName = \`users/\${userId}/\${Date.now()}.jpg\`
```
</DevTip>

<Checkpoint>
- [ ] 버킷에 파일 업로드 완료
- [ ] 폴더 생성 완료 (선택사항)
- [ ] 파일 URL 확인 완료
</Checkpoint>

</Step>

<Step number={3} title="Row Level Security (RLS) 정책 설정하기">

Storage에도 RLS 정책을 적용하여 파일 접근을 제어할 수 있습니다.

1. **Storage** 메뉴에서 `avatars` 버킷을 선택합니다
2. 우측 상단의 **Policies** 버튼을 클릭합니다
3. **New policy** 버튼을 클릭합니다

<Screenshot
  src="https://res.cloudinary.com/demo/image/upload/v1234567890/guides/supabase-storage-setup/step3-rls-policy-ko.png"
  alt="Storage RLS 정책"
  caption="Storage 버킷에 RLS 정책을 추가합니다"
/>

### 정책 1: 모든 사용자가 파일 읽기 가능 (Public Read)

<CopyBlock language="sql">
{`CREATE POLICY "Public Access"
ON storage.objects FOR SELECT
USING (bucket_id = 'avatars');`}
</CopyBlock>

대시보드에서 설정:
1. **Policy name**: "Public Access"
2. **Allowed operation**: `SELECT`
3. **USING expression**:
   ```sql
   bucket_id = 'avatars'
   ```

### 정책 2: 인증된 사용자만 업로드 가능

<CopyBlock language="sql">
{`CREATE POLICY "Authenticated users can upload"
ON storage.objects FOR INSERT
WITH CHECK (
  bucket_id = 'avatars'
  AND auth.role() = 'authenticated'
);`}
</CopyBlock>

### 정책 3: 사용자는 자신의 파일만 수정/삭제 가능

<CopyBlock language="sql">
{`CREATE POLICY "Users can update own files"
ON storage.objects FOR UPDATE
USING (
  bucket_id = 'avatars'
  AND auth.uid()::text = (storage.foldername(name))[1]
);

CREATE POLICY "Users can delete own files"
ON storage.objects FOR DELETE
USING (
  bucket_id = 'avatars'
  AND auth.uid()::text = (storage.foldername(name))[1]
);`}
</CopyBlock>

이 정책은 파일 경로가 `users/{user_id}/...` 형태일 때, `{user_id}`와 현재 로그인한 사용자 ID가 일치하는지 확인합니다.

<DevTip title="Storage RLS 정책 패턴">
**1. Public Read, Authenticated Write:**
```sql
-- 읽기: 모두 허용
CREATE POLICY "Public can read" ON storage.objects
FOR SELECT USING (bucket_id = 'avatars');

-- 쓰기: 인증된 사용자만
CREATE POLICY "Authenticated can write" ON storage.objects
FOR INSERT WITH CHECK (
  bucket_id = 'avatars'
  AND auth.role() = 'authenticated'
);
```

**2. 사용자별 폴더 격리:**
```sql
-- 파일 경로: users/{user_id}/...
CREATE POLICY "User folder access" ON storage.objects
FOR ALL USING (
  bucket_id = 'avatars'
  AND (storage.foldername(name))[1] = auth.uid()::text
);
```

**3. 파일 크기 제한:**
```sql
CREATE POLICY "Limit file size" ON storage.objects
FOR INSERT WITH CHECK (
  bucket_id = 'avatars'
  AND octet_length(decode(encode(name, 'escape'), 'base64')) < 10485760  -- 10MB
);
```

**4. 파일 타입 제한 (이미지만):**
```sql
CREATE POLICY "Images only" ON storage.objects
FOR INSERT WITH CHECK (
  bucket_id = 'avatars'
  AND (
    name LIKE '%.jpg'
    OR name LIKE '%.jpeg'
    OR name LIKE '%.png'
    OR name LIKE '%.gif'
    OR name LIKE '%.webp'
  )
);
```

**유용한 Storage 함수:**
- `storage.foldername(name)`: 파일 경로를 배열로 반환
  - 예: `users/123/profile.jpg` → `['users', '123', 'profile.jpg']`
- `storage.filename(name)`: 파일 이름만 반환
  - 예: `users/123/profile.jpg` → `profile.jpg`
- `storage.extension(name)`: 파일 확장자 반환
  - 예: `profile.jpg` → `jpg`
</DevTip>

<Checkpoint>
- [ ] Storage Policies 접근 완료
- [ ] Public read 정책 생성 완료
- [ ] Authenticated upload 정책 생성 완료
- [ ] User-specific 정책 생성 완료 (선택사항)
</Checkpoint>

</Step>

<Step number={4} title="JavaScript로 파일 업로드 및 다운로드하기">

애플리케이션에서 Supabase Storage를 사용하는 방법을 알아봅시다.

### 파일 업로드하기

<CopyBlock language="javascript">
{`import { createClient } from '@supabase/supabase-js'

const supabase = createClient(supabaseUrl, supabaseAnonKey)

// 파일 업로드 함수
async function uploadFile(file) {
  const fileExt = file.name.split('.').pop()
  const fileName = \`\${Date.now()}.\${fileExt}\`
  const filePath = \`users/\${user.id}/\${fileName}\`

  const { data, error } = await supabase.storage
    .from('avatars')
    .upload(filePath, file, {
      cacheControl: '3600',
      upsert: false  // 기존 파일 덮어쓰기 방지
    })

  if (error) {
    console.error('Upload error:', error)
    return null
  }

  console.log('Uploaded file:', data.path)
  return data
}`}
</CopyBlock>

### React 컴포넌트 예시 (파일 업로드)

<CopyBlock language="tsx">
{`'use client'

import { useState } from 'react'
import { createClient } from '@/lib/supabase/client'

export default function FileUploader() {
  const [uploading, setUploading] = useState(false)
  const [fileUrl, setFileUrl] = useState<string | null>(null)
  const supabase = createClient()

  async function handleUpload(event: React.ChangeEvent<HTMLInputElement>) {
    try {
      setUploading(true)

      const file = event.target.files?.[0]
      if (!file) return

      const fileExt = file.name.split('.').pop()
      const fileName = \`\${Math.random()}\.\${fileExt}\`
      const filePath = \`public/\${fileName}\`

      // 파일 업로드
      const { error: uploadError } = await supabase.storage
        .from('avatars')
        .upload(filePath, file)

      if (uploadError) throw uploadError

      // Public URL 가져오기
      const { data } = supabase.storage
        .from('avatars')
        .getPublicUrl(filePath)

      setFileUrl(data.publicUrl)
      alert('업로드 성공!')
    } catch (error) {
      console.error('Error uploading file:', error)
      alert('업로드 실패')
    } finally {
      setUploading(false)
    }
  }

  return (
    <div>
      <input
        type="file"
        onChange={handleUpload}
        disabled={uploading}
        accept="image/*"
      />
      {uploading && <p>업로드 중...</p>}
      {fileUrl && (
        <div>
          <p>업로드된 파일:</p>
          <img src={fileUrl} alt="Uploaded" style={{ maxWidth: '300px' }} />
        </div>
      )}
    </div>
  )
}`}
</CopyBlock>

### 파일 다운로드하기

<CopyBlock language="javascript">
{`// Public 버킷: Public URL로 직접 접근
const { data } = supabase.storage
  .from('avatars')
  .getPublicUrl('public/image.jpg')

console.log(data.publicUrl)
// https://project.supabase.co/storage/v1/object/public/avatars/public/image.jpg

// Private 버킷: Signed URL 생성 (만료 시간 포함)
const { data, error } = await supabase.storage
  .from('documents')
  .createSignedUrl('private/document.pdf', 60)  // 60초 동안 유효

if (data) {
  console.log(data.signedUrl)
  // https://project.supabase.co/storage/v1/object/sign/documents/private/document.pdf?token=xxx
}

// 파일 다운로드
const { data, error } = await supabase.storage
  .from('avatars')
  .download('public/image.jpg')

if (data) {
  const url = URL.createObjectURL(data)
  const a = document.createElement('a')
  a.href = url
  a.download = 'image.jpg'
  a.click()
}`}
</CopyBlock>

### 파일 삭제하기

<CopyBlock language="javascript">
{`// 단일 파일 삭제
const { error } = await supabase.storage
  .from('avatars')
  .remove(['public/image.jpg'])

// 여러 파일 삭제
const { error } = await supabase.storage
  .from('avatars')
  .remove([
    'public/image1.jpg',
    'public/image2.jpg',
    'public/image3.jpg'
  ])

// 폴더 내 모든 파일 삭제
const { data: files } = await supabase.storage
  .from('avatars')
  .list('users/123')

const filesToRemove = files.map(file => \`users/123/\${file.name}\`)

const { error } = await supabase.storage
  .from('avatars')
  .remove(filesToRemove)`}
</CopyBlock>

### 파일 목록 조회

<CopyBlock language="javascript">
{`// 버킷 내 모든 파일 조회
const { data, error } = await supabase.storage
  .from('avatars')
  .list('public', {
    limit: 100,
    offset: 0,
    sortBy: { column: 'name', order: 'asc' }
  })

// 검색 (파일 이름 필터링)
const { data, error } = await supabase.storage
  .from('avatars')
  .list('public', {
    search: 'profile'  // 'profile'이 포함된 파일만
  })

console.log(data)
// [
//   { name: 'profile1.jpg', id: '...', created_at: '...' },
//   { name: 'profile2.jpg', id: '...', created_at: '...' }
// ]`}
</CopyBlock>

<Screenshot
  src="https://res.cloudinary.com/demo/image/upload/v1234567890/guides/supabase-storage-setup/step4-javascript-upload-ko.png"
  alt="JavaScript 파일 업로드"
  caption="React 컴포넌트에서 Supabase Storage로 파일을 업로드합니다"
/>

<DevTip title="파일 업로드 최적화 팁">
**1. 클라이언트 사이드 이미지 리사이징:**
```javascript
import imageCompression from 'browser-image-compression'

async function compressImage(file) {
  const options = {
    maxSizeMB: 1,           // 최대 1MB
    maxWidthOrHeight: 1920, // 최대 1920px
    useWebWorker: true
  }

  const compressedFile = await imageCompression(file, options)
  return compressedFile
}

// 사용
const compressed = await compressImage(originalFile)
await supabase.storage.from('avatars').upload(path, compressed)
```

**2. 업로드 진행률 표시:**
```javascript
const { data, error } = await supabase.storage
  .from('avatars')
  .upload(filePath, file, {
    onUploadProgress: (progress) => {
      const percent = (progress.loaded / progress.total) * 100
      console.log(\`Upload progress: \${percent}%\`)
    }
  })
```

**3. 멀티파트 업로드 (대용량 파일):**
```javascript
// TUS 프로토콜 사용 (자동 재개 가능)
const { data, error } = await supabase.storage
  .from('videos')
  .upload(filePath, largeFile, {
    resumable: true  // 업로드 중단 시 재개 가능
  })
```

**4. 파일 타입 검증:**
```javascript
const allowedTypes = ['image/jpeg', 'image/png', 'image/webp']

if (!allowedTypes.includes(file.type)) {
  alert('이미지 파일만 업로드 가능합니다.')
  return
}
```
</DevTip>

<Checkpoint>
- [ ] 파일 업로드 코드 작성 완료
- [ ] Public URL 가져오기 완료
- [ ] 파일 다운로드 코드 작성 완료
- [ ] 파일 삭제 코드 작성 완료
- [ ] React 컴포넌트에서 업로드 테스트 완료
</Checkpoint>

</Step>

<Step number={5} title="이미지 변환 및 CDN 활용하기">

Supabase Storage는 내장 이미지 변환 기능과 CDN을 제공합니다.

### 이미지 변환 (Resize, Format)

URL 파라미터로 이미지를 동적으로 변환할 수 있습니다:

<CopyBlock language="javascript">
{`// 기본 Public URL
const publicUrl = supabase.storage
  .from('avatars')
  .getPublicUrl('profile.jpg')

console.log(publicUrl.data.publicUrl)
// https://project.supabase.co/storage/v1/object/public/avatars/profile.jpg

// 이미지 변환 URL (리사이징)
const transformedUrl = supabase.storage
  .from('avatars')
  .getPublicUrl('profile.jpg', {
    transform: {
      width: 400,
      height: 400,
      resize: 'cover'  // cover, contain, fill
    }
  })

console.log(transformedUrl.data.publicUrl)
// https://project.supabase.co/storage/v1/render/image/public/avatars/profile.jpg?width=400&height=400`}
</CopyBlock>

### 사용 가능한 변환 옵션

<CopyBlock language="javascript">
{`const { data } = supabase.storage
  .from('avatars')
  .getPublicUrl('image.jpg', {
    transform: {
      width: 800,          // 너비 (px)
      height: 600,         // 높이 (px)
      resize: 'cover',     // cover, contain, fill
      format: 'webp',      // webp, jpeg, png, avif
      quality: 80          // 1-100 (기본: 80)
    }
  })`}
</CopyBlock>

### 반응형 이미지 예시

<CopyBlock language="tsx">
{`export function ResponsiveImage({ path }: { path: string }) {
  const supabase = createClient()

  // 다양한 크기의 이미지 URL 생성
  const getSrcSet = () => {
    const sizes = [400, 800, 1200]
    return sizes
      .map(size => {
        const { data } = supabase.storage
          .from('avatars')
          .getPublicUrl(path, {
            transform: { width: size, format: 'webp' }
          })
        return \`\${data.publicUrl} \${size}w\`
      })
      .join(', ')
  }

  const { data } = supabase.storage
    .from('avatars')
    .getPublicUrl(path, {
      transform: { width: 800, format: 'webp' }
    })

  return (
    <img
      src={data.publicUrl}
      srcSet={getSrcSet()}
      sizes="(max-width: 600px) 400px, (max-width: 1200px) 800px, 1200px"
      alt="Responsive image"
      loading="lazy"
    />
  )
}`}
</CopyBlock>

### Next.js Image 컴포넌트와 통합

<CopyBlock language="tsx">
{`import Image from 'next/image'
import { createClient } from '@/lib/supabase/client'

export function SupabaseImage({ path }: { path: string }) {
  const supabase = createClient()

  const { data } = supabase.storage
    .from('avatars')
    .getPublicUrl(path)

  return (
    <Image
      src={data.publicUrl}
      alt="Image"
      width={800}
      height={600}
      quality={90}
      priority={false}
    />
  )
}`}
</CopyBlock>

### CDN 캐싱

Supabase Storage는 자동으로 CDN 캐싱을 적용합니다:

- **Public 파일**: 자동으로 CDN에 캐시됨
- **캐시 기간**: 기본 1시간 (Cache-Control 헤더로 제어 가능)
- **캐시 무효화**: 파일 경로를 변경하거나 쿼리 파라미터 추가

<CopyBlock language="javascript">
{`// 업로드 시 캐시 설정
const { data, error } = await supabase.storage
  .from('avatars')
  .upload(filePath, file, {
    cacheControl: '3600'  // 1시간 (초 단위)
  })

// 캐시 무효화를 위한 쿼리 파라미터 추가
const url = \`\${publicUrl}?v=\${Date.now()}\`
// 또는 파일명에 버전 포함: image-v2.jpg`}
</CopyBlock>

<Screenshot
  src="https://res.cloudinary.com/demo/image/upload/v1234567890/guides/supabase-storage-setup/step5-image-transform-ko.png"
  alt="이미지 변환"
  caption="Supabase Storage의 이미지 변환 기능으로 다양한 크기의 이미지 생성"
/>

<DevTip title="이미지 최적화 베스트 프랙티스">
**1. WebP 형식 사용:**
- WebP는 JPEG보다 25-35% 작은 파일 크기
- 모던 브라우저에서 모두 지원
- Fallback을 위해 `<picture>` 태그 사용

```tsx
<picture>
  <source srcSet={webpUrl} type="image/webp" />
  <img src={jpegUrl} alt="Image" />
</picture>
```

**2. 적절한 이미지 크기:**
- 모바일: 400-800px
- 태블릿: 800-1200px
- 데스크톱: 1200-1920px
- 레티나: 2배 크기 (예: 1600px for 800px display)

**3. Lazy Loading:**
```tsx
<img src={url} loading="lazy" />
```

**4. 블러 플레이스홀더:**
```tsx
// 작은 블러 이미지 먼저 로드
const { data: blurData } = supabase.storage
  .from('avatars')
  .getPublicUrl(path, {
    transform: { width: 20, quality: 20 }
  })

<Image
  src={fullUrl}
  placeholder="blur"
  blurDataURL={blurData.publicUrl}
/>
```

**5. 파일명에 해시 포함 (캐시 버스팅):**
```javascript
const hash = await generateHash(file)
const fileName = \`\${hash}-\${originalName}\`
```
</DevTip>

<Checkpoint>
- [ ] 이미지 변환 URL 생성 완료
- [ ] 반응형 이미지 구현 완료
- [ ] Next.js Image와 통합 완료
- [ ] CDN 캐싱 설정 확인
</Checkpoint>

</Step>

## 다음 단계

파일 스토리지 설정을 완료했습니다! 이제 다음 기능들을 추가해보세요.

### 추천 가이드

1. **[Supabase 데이터베이스 설정 가이드](../supabase-database-setup)**
   - 파일 메타데이터를 데이터베이스에 저장
   - 파일과 사용자 연결
   - 예상 소요 시간: 20분

2. **[Supabase 인증 설정 가이드](../supabase-auth-setup)**
   - 사용자별 파일 접근 제어
   - RLS와 인증 통합
   - 예상 소요 시간: 25분

## 문제 해결

### 파일 업로드가 실패해요

**확인 사항:**
1. 파일 크기가 제한을 초과하는지 확인 (무료: 50MB, Pro: 5GB)
2. RLS 정책이 업로드를 허용하는지 확인
3. 버킷 이름과 파일 경로가 올바른지 확인
4. 인증 토큰이 유효한지 확인

**해결 방법:**
<CopyBlock language="javascript">
{`// 에러 로그 확인
const { data, error } = await supabase.storage
  .from('avatars')
  .upload(filePath, file)

if (error) {
  console.error('Error code:', error.statusCode)
  console.error('Error message:', error.message)
  console.error('Error details:', error)
}`}
</CopyBlock>

### Public URL에 접근할 수 없어요

**원인**: Private 버킷의 파일은 Public URL로 접근 불가

**해결 방법:**
1. 버킷을 Public으로 변경하거나
2. Signed URL 사용:
<CopyBlock language="javascript">
{`const { data, error } = await supabase.storage
  .from('private-bucket')
  .createSignedUrl('file.pdf', 3600)  // 1시간 유효

console.log(data.signedUrl)  // 이 URL로 접근`}
</CopyBlock>

### 이미지 변환이 작동하지 않아요

**확인 사항:**
1. 파일이 이미지 형식인지 확인 (JPEG, PNG, WebP, GIF 등)
2. Public 버킷인지 확인 (Private 버킷은 변환 불가)
3. URL이 `/render/image/` 경로를 포함하는지 확인

**올바른 변환 URL:**
```
https://project.supabase.co/storage/v1/render/image/public/avatars/image.jpg?width=400
```

### RLS 정책 때문에 파일을 삭제할 수 없어요

**해결 방법:**
1. Storage Policies에서 DELETE 정책 확인
2. 임시로 모든 작업 허용 정책 추가 (개발 중):
<CopyBlock language="sql">
{`CREATE POLICY "Temporary allow all" ON storage.objects
FOR ALL USING (bucket_id = 'avatars');`}
</CopyBlock>

3. 완성 후 적절한 정책으로 교체

## 유용한 리소스

- [Supabase Storage 공식 문서](https://supabase.com/docs/guides/storage)
- [Storage RLS 가이드](https://supabase.com/docs/guides/storage/security/access-control)
- [이미지 변환 문서](https://supabase.com/docs/guides/storage/serving/image-transformations)
- [Supabase Storage API 레퍼런스](https://supabase.com/docs/reference/javascript/storage)
- [TUS 프로토콜 (재개 가능한 업로드)](https://tus.io/)
