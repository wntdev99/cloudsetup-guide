# GCP Text-to-Speech API 설정 - 텍스트를 음성으로 변환하기

Google Cloud Text-to-Speech API는 **텍스트를 자연스러운 음성으로 변환**하고, **40개 이상의 언어와 220개 이상의 음성**을 지원하며, **WaveNet AI 기술**로 사람과 구별하기 어려운 고품질 음성을 생성합니다. 이 가이드를 따라 Text-to-Speech API를 활성화하고 첫 번째 음성 합성을 12분 안에 실행해보세요!

<FreeTierInfo
  service="Cloud Text-to-Speech API"
  limit="WaveNet 월 100만자"
  period="월간"
  status="generous"
/>

## Text-to-Speech API로 무엇을 할 수 있나요?

<Callout type="info">
🔊 **주요 Text-to-Speech API 기능**

- **음성 합성**: 텍스트를 자연스러운 음성으로 자동 변환
- **다양한 음성**: 220개 이상의 음성 (남성, 여성, 뉴트럴)
- **다국어 지원**: 40개 이상 언어 및 방언
- **WaveNet AI**: DeepMind의 AI 기술로 최고 품질 음성 생성
- **SSML 지원**: 발음, 속도, 음높이 세밀 제어
- **오디오 형식**: MP3, WAV, OGG 등 다양한 형식 지원

**사용 사례**:
- 오디오북 자동 생성
- IVR(자동 응답 시스템) 음성
- 접근성 향상 (시각 장애인 지원)
- 동영상 내레이션
</Callout>

## 시작하기 전에

<PrerequisiteCheck items={[
  { text: "GCP 계정 및 프로젝트 생성 완료", required: true },
  { text: "결제 계정 연결 완료", required: true },
  { text: "음성으로 변환할 샘플 텍스트 준비", required: false }
]} />

<Callout type="tip">
💡 **무료 체험**: WaveNet 음성은 월 100만자, Standard 음성은 월 400만자까지 무료입니다!
</Callout>

---

<Step number={1} title="Text-to-Speech API 활성화">

1. [Google Cloud Console](https://console.cloud.google.com)에 로그인합니다.
2. 올바른 프로젝트가 선택되었는지 확인하세요.
3. 상단 검색창에 **"Text-to-Speech"**를 입력합니다.
4. 검색 결과에서 **Cloud Text-to-Speech API**를 클릭합니다.

<Screenshot
  src="https://res.cloudinary.com/demo/image/upload/gcp-text-to-speech-step1-ko.png"
  alt="Text-to-Speech API 검색"
  caption="검색창에서 Text-to-Speech API를 찾으세요"
/>

5. **사용 설정(ENABLE)** 버튼을 클릭합니다.
6. API 활성화에 몇 초 정도 소요됩니다.

<Screenshot
  src="https://res.cloudinary.com/demo/image/upload/gcp-text-to-speech-step1b-ko.png"
  alt="Text-to-Speech API 활성화"
  caption="사용 설정 버튼을 클릭하여 API를 활성화하세요"
/>

<Checkpoint
  title="API 활성화 확인"
  items={[
    "API가 활성화되었나요?",
    "'API 사용 설정됨' 페이지로 이동했나요?"
  ]}
/>

</Step>

---

<Step number={2} title="API 키 준비">

Text-to-Speech API를 사용하려면 **API 키** 또는 **서비스 계정**이 필요합니다.

### 2-1. 기존 API 키 재사용

이미 다른 GCP API를 위해 API 키를 만든 경우:

1. 왼쪽 메뉴에서 **사용자 인증 정보(Credentials)** 클릭
2. 기존 API 키 확인
3. API 키의 **API 제한사항** 섹션에 **Cloud Text-to-Speech API** 추가:
   - API 키 이름 클릭
   - **API 제한사항**에서 **키 제한** 선택
   - **Cloud Text-to-Speech API** 체크박스 선택
   - **저장** 클릭

### 2-2. 새 API 키 만들기

1. **사용자 인증 정보(Credentials)** 페이지에서 **+ 사용자 인증 정보 만들기** 클릭
2. **API 키** 선택
3. 생성된 API 키를 **복사**하여 안전하게 보관
4. **키 제한** 버튼 클릭하여 보안 설정:
   - **API 제한사항**: "키 제한" 선택
   - **Cloud Text-to-Speech API**만 체크
   - **저장** 클릭

<Screenshot
  src="https://res.cloudinary.com/demo/image/upload/gcp-text-to-speech-step2-ko.png"
  alt="API 키 생성 및 제한"
  caption="Text-to-Speech API만 사용 가능하도록 제한하세요"
/>

<Callout type="warning">
⚠️ **API 키 보안**

API 키는 누구나 사용할 수 있는 비밀번호와 같습니다:
- GitHub, 블로그, 공개 저장소에 절대 업로드하지 마세요
- 환경 변수나 설정 파일에 저장하고 .gitignore에 추가하세요
- 프로덕션에서는 서비스 계정을 사용하세요
</Callout>

</Step>

---

<Step number={3} title="Text-to-Speech API 테스트 - 웹 콘솔">

가장 쉬운 방법은 GCP 콘솔에서 직접 테스트하는 것입니다.

1. Text-to-Speech API 페이지로 돌아갑니다.
2. **이 API 사용해 보기(TRY THIS API)** 버튼을 클릭합니다.
3. 오른쪽 패널이 열립니다.

### 3-1. 샘플 텍스트로 테스트

1. **Request body** 섹션에 다음 JSON을 입력합니다:

<CopyBlock
  code='{
  "input": {
    "text": "안녕하세요, 구글 클라우드 텍스트-투-스피치입니다."
  },
  "voice": {
    "languageCode": "ko-KR",
    "name": "ko-KR-Wavenet-A"
  },
  "audioConfig": {
    "audioEncoding": "MP3"
  }
}'
  language="json"
/>

2. 아래로 스크롤하여 **실행(EXECUTE)** 버튼을 클릭합니다.
3. Google 계정 권한 요청이 나타나면 **허용(Allow)** 클릭합니다.

<Screenshot
  src="https://res.cloudinary.com/demo/image/upload/gcp-text-to-speech-step3-ko.png"
  alt="Text-to-Speech API 테스트"
  caption="샘플 요청을 실행하여 API를 테스트하세요"
/>

### 3-2. 결과 확인

다음과 같은 응답을 받게 됩니다:

<CopyBlock
  code='{
  "audioContent": "//NExAAQVAH8AUkQACMA4AA..."
}'
  language="json"
/>

`audioContent`는 Base64로 인코딩된 오디오 데이터입니다. 이를 디코딩하면 MP3 파일을 얻을 수 있습니다.

<Callout type="success">
✅ **성공!** Text-to-Speech API가 텍스트를 음성으로 변환했습니다!
</Callout>

</Step>

---

<Step number={4} title="Text-to-Speech API 테스트 - cURL">

실제 개발에서는 코드나 명령줄에서 API를 호출하게 됩니다.

### 4-1. 텍스트를 음성으로 변환

터미널이나 명령 프롬프트를 열고 다음을 실행하세요:

<CopyBlock
  code='curl -X POST \
  -H "Content-Type: application/json" \
  "https://texttospeech.googleapis.com/v1/text:synthesize?key=YOUR_API_KEY" \
  -d "{
    \"input\": {
      \"text\": \"안녕하세요, 오늘 날씨가 좋네요.\"
    },
    \"voice\": {
      \"languageCode\": \"ko-KR\",
      \"name\": \"ko-KR-Wavenet-A\"
    },
    \"audioConfig\": {
      \"audioEncoding\": \"MP3\"
    }
  }"'
  language="bash"
/>

**주의**: `YOUR_API_KEY`를 실제 API 키로 바꾸세요!

<Screenshot
  src="https://res.cloudinary.com/demo/image/upload/gcp-text-to-speech-step4-ko.png"
  alt="cURL로 API 호출"
  caption="터미널에서 직접 Text-to-Speech API를 호출하세요"
/>

### 4-2. 오디오 파일로 저장

Base64 응답을 디코딩하여 MP3 파일로 저장:

<CopyBlock
  code='# 1. API 호출하여 JSON 응답 저장
curl -X POST \
  -H "Content-Type: application/json" \
  "https://texttospeech.googleapis.com/v1/text:synthesize?key=YOUR_API_KEY" \
  -d "{
    \"input\": {\"text\": \"Hello, world!\"},
    \"voice\": {\"languageCode\": \"en-US\", \"name\": \"en-US-Wavenet-D\"},
    \"audioConfig\": {\"audioEncoding\": \"MP3\"}
  }" > response.json

# 2. audioContent 추출 및 Base64 디코딩
cat response.json | jq -r ".audioContent" | base64 --decode > output.mp3

# 3. 오디오 재생 (macOS)
afplay output.mp3

# 또는 (Linux)
mpg123 output.mp3'
  language="bash"
/>

### 4-3. 다양한 음성 사용

남성, 여성, 뉴트럴 음성 중 선택:

<CopyBlock
  code='# 한국어 여성 음성 (WaveNet)
"voice": {
  "languageCode": "ko-KR",
  "name": "ko-KR-Wavenet-A"
}

# 한국어 남성 음성 (WaveNet)
"voice": {
  "languageCode": "ko-KR",
  "name": "ko-KR-Wavenet-C"
}

# 영어 여성 음성 (WaveNet)
"voice": {
  "languageCode": "en-US",
  "name": "en-US-Wavenet-F"
}

# 영어 남성 음성 (Standard)
"voice": {
  "languageCode": "en-US",
  "name": "en-US-Standard-B"
}'
  language="json"
/>

<Checkpoint
  title="API 테스트 성공 확인"
  items={[
    "cURL 명령이 오류 없이 실행되었나요?",
    "JSON 응답에 audioContent가 포함되어 있나요?",
    "오디오 파일이 정상적으로 재생되나요?"
  ]}
/>

</Step>

---

<Step number={5} title="실제 코드에서 사용하기">

이제 프로그래밍 언어에서 Text-to-Speech API를 호출해봅시다.

### 5-1. Python 예제

<CopyBlock
  code='import requests
import base64

API_KEY = "YOUR_API_KEY"
url = f"https://texttospeech.googleapis.com/v1/text:synthesize?key={API_KEY}"

# 음성 합성 요청
request_body = {
    "input": {
        "text": "안녕하세요, 텍스트를 음성으로 변환하는 예제입니다."
    },
    "voice": {
        "languageCode": "ko-KR",
        "name": "ko-KR-Wavenet-A"
    },
    "audioConfig": {
        "audioEncoding": "MP3",
        "speakingRate": 1.0,  # 재생 속도 (0.25 ~ 4.0)
        "pitch": 0.0          # 음높이 (-20.0 ~ 20.0)
    }
}

response = requests.post(url, json=request_body)
result = response.json()

# Base64 디코딩 후 MP3 파일로 저장
if "audioContent" in result:
    audio_content = base64.b64decode(result["audioContent"])

    with open("output.mp3", "wb") as out:
        out.write(audio_content)

    print("음성 파일이 output.mp3로 저장되었습니다!")
else:
    print("오류:", result)'
  language="python"
/>

### 5-2. Node.js 예제

<CopyBlock
  code='const axios = require("axios");
const fs = require("fs");

const API_KEY = "YOUR_API_KEY";
const url = `https://texttospeech.googleapis.com/v1/text:synthesize?key=${API_KEY}`;

// 음성 합성 요청
const requestBody = {
  input: {
    text: "Hello, this is a text-to-speech example."
  },
  voice: {
    languageCode: "en-US",
    name: "en-US-Wavenet-D"
  },
  audioConfig: {
    audioEncoding: "MP3",
    speakingRate: 1.0,  // Speaking rate (0.25 ~ 4.0)
    pitch: 0.0          // Pitch (-20.0 ~ 20.0)
  }
};

axios.post(url, requestBody)
  .then(response => {
    const audioContent = response.data.audioContent;

    // Base64 decode and save as MP3
    const audioBuffer = Buffer.from(audioContent, "base64");
    fs.writeFileSync("output.mp3", audioBuffer);

    console.log("Audio saved to output.mp3!");
  })
  .catch(error => console.error("Error:", error.response?.data || error.message));'
  language="javascript"
/>

### 5-3. SSML 사용하기

SSML(Speech Synthesis Markup Language)로 발음, 속도, 음높이를 세밀하게 제어:

<CopyBlock
  code='import requests
import base64

API_KEY = "YOUR_API_KEY"
url = f"https://texttospeech.googleapis.com/v1/text:synthesize?key={API_KEY}"

# SSML로 세밀한 제어
ssml_text = """
<speak>
  안녕하세요!
  <break time="1s"/>
  오늘은 <prosody rate="slow" pitch="+2st">날씨가 정말 좋네요</prosody>.
  <break time="500ms"/>
  <emphasis level="strong">강조된 텍스트</emphasis>입니다.
</speak>
"""

request_body = {
    "input": {
        "ssml": ssml_text  # "text" 대신 "ssml" 사용
    },
    "voice": {
        "languageCode": "ko-KR",
        "name": "ko-KR-Wavenet-B"
    },
    "audioConfig": {
        "audioEncoding": "MP3"
    }
}

response = requests.post(url, json=request_body)
result = response.json()

audio_content = base64.b64decode(result["audioContent"])
with open("output_ssml.mp3", "wb") as out:
    out.write(audio_content)

print("SSML 음성 파일이 생성되었습니다!")'
  language="python"
/>

### 5-4. 사용 가능한 음성 목록 조회

모든 지원 음성을 조회할 수 있습니다:

<CopyBlock
  code='import requests

API_KEY = "YOUR_API_KEY"
url = f"https://texttospeech.googleapis.com/v1/voices?key={API_KEY}"

response = requests.get(url)
voices = response.json()["voices"]

# 한국어 음성만 필터링
ko_voices = [v for v in voices if "ko-KR" in v["languageCodes"]]

for voice in ko_voices:
    name = voice["name"]
    gender = voice["ssmlGender"]
    print(f"{name} ({gender})")'
  language="python"
/>

<Callout type="success">
🎉 **완료!** Text-to-Speech API를 활성화하고 성공적으로 음성을 합성했습니다!
</Callout>

</Step>

---

## 비용 관리

<Callout type="info">
💰 **Text-to-Speech API 가격 정책**

- **무료 티어**:
  - WaveNet 음성: 월 100만자
  - Standard 음성: 월 400만자
  - 음성 목록 조회: 무료 (무제한)

- **초과 시 요금** (100만자당):
  - WaveNet 음성: $16
  - Neural2 음성: $16
  - Standard 음성: $4

**예시**: WaveNet 음성으로 월 300만자 합성
- 무료: 100만자
- 유료: 200만자 × ($16 / 100만자) = **$32**
</Callout>

---

## 다음 단계

Text-to-Speech API를 마스터했으니, 다른 AI API도 사용해보세요:

1. **[Speech-to-Text API 설정](../gcp-speech-to-text-setup)** - 음성을 텍스트로 변환
2. **[Translation API 설정](../gcp-translation-api-setup)** - 100개 언어 자동 번역
3. **[Vision API 설정](../gcp-vision-api-setup)** - 이미지 분석 AI

---

## 자주 묻는 질문

<Callout type="info">
**Q. WaveNet과 Standard의 차이는?**

A. 음질과 가격의 차이입니다:
- **WaveNet**: DeepMind AI 기술, 사람과 거의 구별 불가, 비쌈 ($16/100만자)
- **Neural2**: WaveNet과 유사한 품질, 동일 가격 ($16/100만자)
- **Standard**: 기본 음질, 저렴 ($4/100만자)

권장: 일반적인 용도는 WaveNet, 대량 생성은 Standard
</Callout>

<Callout type="info">
**Q. 지원하는 언어는?**

A. 40개 이상의 언어와 220개 이상의 음성:
- 한국어 (ko-KR): 4개 음성 (남성 2, 여성 2)
- 영어 (en-US): 30개 이상 음성
- 일본어 (ja-JP): 4개 음성
- 중국어 (zh-CN, zh-TW): 각 4개 음성
- 스페인어, 프랑스어, 독일어 등

전체 목록: `/voices` API 엔드포인트로 조회
</Callout>

<Callout type="info">
**Q. SSML이란?**

A. Speech Synthesis Markup Language:
- 발음, 속도, 음높이를 세밀하게 제어
- 일시 정지 (`<break>`)
- 강조 (`<emphasis>`)
- 속도/음높이 조절 (`<prosody>`)
- 예시: `<speak>안녕하세요 <break time="1s"/> 반갑습니다</speak>`

자세한 내용은 [SSML 가이드](https://cloud.google.com/text-to-speech/docs/ssml)를 참고하세요.
</Callout>

<Callout type="info">
**Q. 오디오 형식은?**

A. 다양한 형식 지원:
- **MP3**: 가장 범용적, 압축률 높음
- **LINEAR16** (WAV): 비압축, 최고 품질
- **OGG_OPUS**: 웹 스트리밍에 적합
- **MULAW**: 전화 시스템용

권장: 일반적인 용도는 MP3, 고품질은 LINEAR16
</Callout>

---

## 문제 해결

### "Invalid voice name" 오류

- 언어 코드와 음성 이름이 일치하는지 확인
- `/voices` API로 사용 가능한 음성 목록 조회
- 예: `ko-KR-Wavenet-A`는 존재하지만 `ko-KR-Wavenet-Z`는 없음

### audioContent가 비어있어요

- API 키가 올바른지 확인
- 요청 본문 JSON 형식이 올바른지 확인
- 할당량을 초과하지 않았는지 확인

### 음성이 부자연스러워요

- WaveNet 또는 Neural2 음성 사용
- SSML로 발음 미세 조정
- `speakingRate`와 `pitch` 조절
- 다른 음성으로 테스트

### 파일 크기가 너무 커요

- MP3 인코딩 사용 (LINEAR16보다 작음)
- `speakingRate`를 높여서 재생 시간 단축
- 텍스트를 여러 조각으로 나눠서 처리

---

**Text-to-Speech API 설정 완료!** 🎊 이제 자유롭게 음성 합성 서비스를 활용하세요!
