# RabbitMQ 메시지 브로커 설치 및 실행하기

**RabbitMQ**는 오픈소스 메시지 브로커입니다. 응용 프로그램 간에 메시지를 신뢰성 있게 전달합니다. 비동기 작업 처리, 작업 큐, 서비스 간 통신에 사용됩니다. Docker로 RabbitMQ를 설치하고 관리 인터페이스에 접속하세요.

<FreeTierInfo
  service="RabbitMQ"
  limit="오픈소스, 무료 자체 호스팅"
  period="one-time"
  status="free"
/>

## 시작하기 전에

<PrerequisiteCheck items={[
  { text: "Docker 설치", required: true },
  { text: "Docker Compose", required: true },
  { text: "최소 1GB RAM", required: true },
  { text: "웹 브라우저", required: true }
]} />

<Callout type="info">
📬 **RabbitMQ란?** RabbitMQ는 메시지를 생산자(Producer)에서 소비자(Consumer)로 전달합니다. 큐에 메시지를 저장하므로 네트워크 장애 시에도 메시지가 손실되지 않습니다.
</Callout>

---

<Step number={1} title="Docker Compose로 RabbitMQ 설정">

### docker-compose.yml 파일 생성

<CopyBlock language="bash" title="docker-compose.yml 파일 생성">
cat > docker-compose.yml << EOF
version: '3.8'
services:
  rabbitmq:
    image: rabbitmq:3.12-management
    ports:
      - "5672:5672"
      - "15672:15672"
    environment:
      RABBITMQ_DEFAULT_USER: guest
      RABBITMQ_DEFAULT_PASS: guest
    volumes:
      - rabbitmq_data:/var/lib/rabbitmq
    healthcheck:
      test: rabbitmq-diagnostics -q ping
      interval: 30s
      timeout: 10s
      retries: 5

volumes:
  rabbitmq_data:
EOF
</CopyBlock>

### 포트 설명

- **5672**: AMQP 프로토콜 포트 (클라이언트 연결)
- **15672**: 관리 인터페이스 포트 (웹 UI)

<Screenshot
  src="https://res.cloudinary.com/demo/image/upload/v1/rabbitmq/step1-compose-setup-ko.png"
  alt="Docker Compose 설정"
  caption="docker-compose.yml 파일을 생성합니다"
  priority={true}
/>

<Callout type="success">
✅ **준비 완료!** 설정 파일이 준비되었습니다.
</Callout>

<Checkpoint>
docker-compose.yml 파일이 생성되었나요?
</Checkpoint>

</Step>

---

<Step number={2} title="RabbitMQ 시작">

### Docker Compose 실행

<CopyBlock language="bash" title="RabbitMQ 시작">
docker-compose up -d
</CopyBlock>

### 실행 확인

<CopyBlock language="bash" title="컨테이너 상태 확인">
docker-compose ps
</CopyBlock>

모든 컨테이너가 healthy 상태인지 확인합니다.

### 로그 확인

<CopyBlock language="bash" title="로그 보기">
docker-compose logs -f rabbitmq
</CopyBlock>

"Ready to accept connections" 메시지가 표시되면 정상입니다.

<Screenshot
  src="https://res.cloudinary.com/demo/image/upload/v1/rabbitmq/step2-start-ko.png"
  alt="RabbitMQ 시작"
  caption="docker-compose up -d로 RabbitMQ를 시작합니다"
/>

<Callout type="success">
✅ **완료!** RabbitMQ가 실행 중입니다.
</Callout>

<Checkpoint>
RabbitMQ가 정상적으로 시작되었나요?
</Checkpoint>

</Step>

---

<Step number={3} title="관리 콘솔 접속">

### 웹 브라우저에서 접속

1. 브라우저에서 다음 URL 방문:
   [http://localhost:15672](http://localhost:15672)

2. 로그인 창이 표시됩니다

### 기본 로그인 정보

- **사용자명**: guest
- **비밀번호**: guest

### 관리 콘솔 기능

로그인 후 다음을 확인할 수 있습니다:

1. **Connections**: 현재 연결된 클라이언트
2. **Channels**: 통신 채널
3. **Queues**: 메시지 큐
4. **Exchanges**: 메시지 라우팅 규칙
5. **Admin**: 사용자 및 권한 관리

<Screenshot
  src="https://res.cloudinary.com/demo/image/upload/v1/rabbitmq/step3-management-ko.png"
  alt="관리 콘솔"
  caption="RabbitMQ 관리 콘솔에 접속합니다"
/>

<Callout type="warning">
⚠️ **중요**: 프로덕션 환경에서는 기본 사용자명과 비밀번호를 변경하세요.
</Callout>

<Checkpoint>
관리 콘솔에 성공적으로 접속했나요?
</Checkpoint>

</Step>

---

<Step number={4} title="클라이언트 라이브러리 설치">

### Python 클라이언트 설치

<CopyBlock language="bash" title="pika 설치">
pip install pika
</CopyBlock>

### Python에서 연결

<CopyBlock language="python" title="Python 연결 테스트">
import pika

try:
  connection = pika.BlockingConnection(pika.ConnectionParameters('localhost'))
  channel = connection.channel()
  print('Connected to RabbitMQ!')
  connection.close()
except Exception as e:
  print(f'Connection failed: {e}')
</CopyBlock>

### Node.js 클라이언트 설치

<CopyBlock language="bash" title="amqplib 설치">
npm install amqplib
</CopyBlock>

### Node.js에서 연결

<CopyBlock language="javascript" title="Node.js 연결 테스트">
const amqp = require('amqplib');

async function connect() {
  try {
    const connection = await amqp.connect('amqp://localhost');
    console.log('Connected to RabbitMQ!');
    await connection.close();
  } catch (error) {
    console.error('Connection failed:', error);
  }
}

connect();
</CopyBlock>

<Screenshot
  src="https://res.cloudinary.com/demo/image/upload/v1/rabbitmq/step4-client-install-ko.png"
  alt="클라이언트 설치"
  caption="Python 또는 Node.js 클라이언트를 설치합니다"
/>

<Callout type="success">
✅ **완료!** 클라이언트가 설치되고 연결되었습니다.
</Callout>

<Checkpoint>
클라이언트 연결이 성공했나요?
</Checkpoint>

</Step>

---

## 다음 단계

- [RabbitMQ 메시지 큐](/guides/rabbitmq-message-queue) - 메시지 발행 및 처리
- [RabbitMQ 공식 문서](https://www.rabbitmq.com/documentation.html)
- [Python pika 가이드](https://pika.readthedocs.io/)

## RabbitMQ 기본 개념

### Exchange

메시지 라우팅 규칙을 정의합니다:

- **Direct**: 라우팅 키가 정확히 일치하면 메시지 전달
- **Topic**: 와일드카드 패턴으로 메시지 라우팅
- **Fanout**: 모든 큐로 메시지 브로드캐스트
- **Headers**: 헤더 속성으로 라우팅

### Queue

메시지를 저장하는 버퍼입니다.

### Binding

Exchange와 Queue를 연결합니다.

### Message

생산자에서 소비자로 전달되는 데이터입니다.

## 포트 정보

- **5672**: AMQP 프로토콜
- **15672**: 관리 콘솔 (HTTP)

## 컨테이너 관리

### 중지

<CopyBlock language="bash" title="RabbitMQ 중지">
docker-compose stop
</CopyBlock>

### 시작

<CopyBlock language="bash" title="RabbitMQ 시작">
docker-compose start
</CopyBlock>

### 완전 제거

<CopyBlock language="bash" title="제거">
docker-compose down -v
</CopyBlock>

---

## 문제 해결

### 포트 충돌

포트가 이미 사용 중이면 docker-compose.yml에서 포트를 변경하세요.

### 연결 실패

1. 모든 컨테이너가 실행 중인지 확인
2. 포트가 올바른지 확인
3. 로그에서 에러 메시지 확인

### 메모리 부족

Docker의 메모리 할당을 증가시키세요.
