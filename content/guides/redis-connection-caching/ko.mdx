# Redis ì—°ê²° ë° ìºì‹± êµ¬í˜„í•˜ê¸°

ì´ì œ **ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ Redisì— ì—°ê²°í•˜ê³  ìºì‹±ì„ êµ¬í˜„**í•˜ëŠ” ë°©ë²•ì„ ë°°ì›ë‹ˆë‹¤. ìºì‹±ì€ ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ë¥¼ ì¤„ì´ê³  ì• í”Œë¦¬ì¼€ì´ì…˜ ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚µë‹ˆë‹¤.

<FreeTierInfo
  service="Redis"
  limit="ë¬´ì œí•œ ì—°ê²° ë° ìºì‹±"
  period="unlimited"
  status="generous"
/>

## ì‹œì‘í•˜ê¸° ì „ì—

<PrerequisiteCheck items={[
  { text: "Redis ì„¤ì¹˜ ë° ì‹¤í–‰", required: true },
  { text: "Python ë˜ëŠ” Node.js", required: true },
  { text: "Redis í´ë¼ì´ì–¸íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬", required: false }
]} />

<Callout type="info">
ğŸš€ **ìºì‹±ì´ë€?** ìºì‹±ì€ ìì£¼ ì‚¬ìš©ë˜ëŠ” ë°ì´í„°ë¥¼ ë¹ ë¥´ê²Œ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ì €ì¥ì†Œì— ì„ì‹œë¡œ ì €ì¥í•˜ëŠ” ê¸°ë²•ì…ë‹ˆë‹¤. RedisëŠ” ë©”ëª¨ë¦¬ ê¸°ë°˜ì´ë¯€ë¡œ ë””ìŠ¤í¬ ê¸°ë°˜ ë°ì´í„°ë² ì´ìŠ¤ë³´ë‹¤ í›¨ì”¬ ë¹ ë¦…ë‹ˆë‹¤.
</Callout>

---

<Step number={1} title="Pythonì—ì„œ Redis ì—°ê²°">

### redis-py ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜

<CopyBlock language="bash" title="redis-py ì„¤ì¹˜">
pip install redis
</CopyBlock>

### ê¸°ë³¸ ì—°ê²° ì½”ë“œ

<CopyBlock language="python" title="Redis ì—°ê²° (Python)">
import redis

r = redis.Redis(host='localhost', port=6379, db=0)

try:
    result = r.ping()
    print("Redis ì—°ê²° ì„±ê³µ:", result)
except Exception as e:
    print("ì—°ê²° ì‹¤íŒ¨:", e)
</CopyBlock>

### ë°ì´í„° ì €ì¥ ë° ì¡°íšŒ

<CopyBlock language="python" title="ë°ì´í„° ì €ì¥ ë° ì¡°íšŒ">
import redis

r = redis.Redis(host='localhost', port=6379, db=0)

r.set('user:1:name', 'John')
name = r.get('user:1:name')
print(name.decode('utf-8'))
</CopyBlock>

<Screenshot
  src="https://res.cloudinary.com/demo/image/upload/v1/redis/step1-python-connection-ko.png"
  alt="Python Redis ì—°ê²°"
  caption="redis-py ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ Redisì— ì—°ê²°í•©ë‹ˆë‹¤"
  priority={true}
/>

<Checkpoint>
Redis ì—°ê²° ì„±ê³µ ë©”ì‹œì§€ê°€ ë‚˜íƒ€ë‚¬ë‚˜ìš”?
</Checkpoint>

</Step>

---

<Step number={2} title="Node.jsì—ì„œ Redis ì—°ê²°">

### node-redis ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜

<CopyBlock language="bash" title="node-redis ì„¤ì¹˜">
npm install redis
</CopyBlock>

### ê¸°ë³¸ ì—°ê²° ì½”ë“œ

<CopyBlock language="javascript" title="Redis ì—°ê²° (Node.js)">
import { createClient } from 'redis';

const client = createClient({
  host: 'localhost',
  port: 6379
});

client.on('error', (err) => console.log('Redis Client Error', err));

await client.connect();
const pong = await client.ping();
console.log('Redis ì—°ê²° ì„±ê³µ:', pong);
</CopyBlock>

### ë¹„ë™ê¸° ë°ì´í„° ì €ì¥ ë° ì¡°íšŒ

<CopyBlock language="javascript" title="ë°ì´í„° ì €ì¥ ë° ì¡°íšŒ">
import { createClient } from 'redis';

const client = createClient();
await client.connect();

await client.set('user:1:name', 'John');
const name = await client.get('user:1:name');
console.log('ì´ë¦„:', name);

await client.disconnect();
</CopyBlock>

<Screenshot
  src="https://res.cloudinary.com/demo/image/upload/v1/redis/step2-nodejs-connection-ko.png"
  alt="Node.js Redis ì—°ê²°"
  caption="node-redisë¡œ Node.jsì—ì„œ Redisë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤"
/>

<DevTip>
Node.jsëŠ” ë¹„ë™ê¸° íŠ¹ì„±ì„ ê°€ì§€ê³  ìˆì–´ì„œ ëª¨ë“  Redis ì‘ì—…ì´ Promiseë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. async/awaitë¥¼ ì‚¬ìš©í•˜ì—¬ ì½”ë“œë¥¼ ê°„ê²°í•˜ê²Œ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
</DevTip>

</Step>

---

<Step number={3} title="ìºì‹± íŒ¨í„´ êµ¬í˜„">

### ìºì‹œ-ì• ì”¬[Cache-Aside] íŒ¨í„´

ë°ì´í„°ê°€ í•„ìš”í•  ë•Œë§ˆë‹¤ ë‹¤ìŒ ì ˆì°¨ë¥¼ ë”°ë¦…ë‹ˆë‹¤:
1. ìºì‹œì—ì„œ ë°ì´í„°ë¥¼ ì°¾ìŠµë‹ˆë‹¤
2. ì—†ìœ¼ë©´ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì¡°íšŒí•©ë‹ˆë‹¤
3. ë°ì´í„°ë¥¼ ìºì‹œì— ì €ì¥í•©ë‹ˆë‹¤

#### Python ì˜ˆì œ

<CopyBlock language="python" title="Cache-Aside íŒ¨í„´ (Python)">
import redis
import json

r = redis.Redis(host='localhost', port=6379, db=0)

def get_user_data(user_id):
    cache_key = f'user:{user_id}'

    cached_data = r.get(cache_key)
    if cached_data:
        print("ìºì‹œì—ì„œ ì¡°íšŒ")
        return json.loads(cached_data)

    print("ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì¡°íšŒ")
    user_data = {
        'id': user_id,
        'name': 'John',
        'email': 'john@example.com'
    }

    r.setex(cache_key, 3600, json.dumps(user_data))
    return user_data

result = get_user_data(1)
print(result)
</CopyBlock>

#### Node.js ì˜ˆì œ

<CopyBlock language="javascript" title="Cache-Aside íŒ¨í„´ (Node.js)">
import { createClient } from 'redis';

const client = createClient();
await client.connect();

async function getUserData(userId) {
    const cacheKey = 'user:' + userId;

    const cachedData = await client.get(cacheKey);
    if (cachedData) {
        console.log("ìºì‹œì—ì„œ ì¡°íšŒ");
        return JSON.parse(cachedData);
    }

    console.log("ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì¡°íšŒ");
    const userData = {
        id: userId,
        name: 'John',
        email: 'john@example.com'
    };

    await client.setEx(cacheKey, 3600, JSON.stringify(userData));
    return userData;
}

const result = await getUserData(1);
console.log(result);
</CopyBlock>

<Screenshot
  src="https://res.cloudinary.com/demo/image/upload/v1/redis/step3-caching-pattern-ko.png"
  alt="ìºì‹± íŒ¨í„´"
  caption="Cache-Aside íŒ¨í„´ìœ¼ë¡œ ì„±ëŠ¥ì„ ê°œì„ í•©ë‹ˆë‹¤"
/>

<Callout type="tip">
ğŸ’¡ **setexì˜ ì˜ë¯¸**: set + expireì˜ ì¡°í•©ì…ë‹ˆë‹¤. ë°ì´í„°ë¥¼ ì €ì¥í•˜ë©´ì„œ ë™ì‹œì— ë§Œë£Œ ì‹œê°„ì„ ì§€ì •í•©ë‹ˆë‹¤.
</Callout>

</Step>

---

<Step number={4} title="ì„¸ì…˜ ì €ì¥ì†Œë¡œ Redis í™œìš©">

ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì‚¬ìš©ì ì„¸ì…˜ì„ Redisì— ì €ì¥í•©ë‹ˆë‹¤.

### Python Flask ì˜ˆì œ

<CopyBlock language="bash" title="Flask ë° redis ì„¤ì¹˜">
pip install flask flask-session redis
</CopyBlock>

<CopyBlock language="python" title="Flask ì„¸ì…˜ ì„¤ì •">
from flask import Flask, session
from flask_session import Session
import redis

app = Flask(__name__)
app.config['SESSION_TYPE'] = 'redis'
app.config['SESSION_REDIS'] = redis.from_url('redis://localhost:6379')

Session(app)

@app.route('/login', methods=['POST'])
def login():
    session['user_id'] = 123
    session['username'] = 'john'
    return 'Session saved'

@app.route('/profile')
def profile():
    user_id = session.get('user_id')
    username = session.get('username')
    return f'User: {username}'

if __name__ == '__main__':
    app.run()
</CopyBlock>

### Node.js Express ì˜ˆì œ

<CopyBlock language="bash" title="Express ë° redis ì„¤ì¹˜">
npm install express express-session connect-redis redis
</CopyBlock>

<CopyBlock language="javascript" title="Express ì„¸ì…˜ ì„¤ì •">
import express from 'express';
import session from 'express-session';
import { createClient } from 'redis';
import RedisStore from 'connect-redis';

const client = createClient();
await client.connect();

const app = express();

app.use(
  session({
    store: new RedisStore({ client }),
    secret: 'your-secret',
    resave: false,
    saveUninitialized: false
  })
);

app.get('/login', (req, res) => {
  req.session.userId = 123;
  req.session.username = 'john';
  res.send('Session saved');
});

app.get('/profile', (req, res) => {
  const username = req.session.username;
  res.send('User: ' + username);
});

app.listen(3000);
</CopyBlock>

<Screenshot
  src="https://res.cloudinary.com/demo/image/upload/v1/redis/step4-session-storage-ko.png"
  alt="ì„¸ì…˜ ì €ì¥ì†Œ"
  caption="Redisë¥¼ ì„¸ì…˜ ì €ì¥ì†Œë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤"
/>

</Step>

---

<Step number={5} title="ê³ ê¸‰ ìºì‹± ì „ëµ">

### ìºì‹œ ë¬´íš¨í™” (Invalidation)

ë°ì´í„°ê°€ ë³€ê²½ë˜ë©´ ìºì‹œë„ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤:

<CopyBlock language="python" title="ìºì‹œ ë¬´íš¨í™”">
import redis

r = redis.Redis(host='localhost', port=6379, db=0)

def update_user(user_id, name):
    cache_key = f'user:{user_id}'
    r.delete(cache_key)

    print("ë°ì´í„°ë² ì´ìŠ¤ ì—…ë°ì´íŠ¸")

    return True

update_user(1, 'Jane')
</CopyBlock>

### ìºì‹œ ì›Œë°ì—… (Warming)

ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘ ì‹œ ìì£¼ ì‚¬ìš©ë˜ëŠ” ë°ì´í„°ë¥¼ ë¯¸ë¦¬ ë¡œë“œ:

<CopyBlock language="python" title="ìºì‹œ ì›Œë°ì—…">
import redis
import json

r = redis.Redis(host='localhost', port=6379, db=0)

def warm_cache():
    users = [
        {'id': 1, 'name': 'John'},
        {'id': 2, 'name': 'Jane'},
        {'id': 3, 'name': 'Bob'}
    ]

    for user in users:
        key = f'user:{user["id"]}'
        r.setex(key, 3600, json.dumps(user))

    print("ìºì‹œ ì›Œë° ì™„ë£Œ")

warm_cache()
</CopyBlock>

### TTL ëª¨ë‹ˆí„°ë§

ìºì‹œ í•­ëª©ì˜ ë‚¨ì€ ì‹œê°„ì„ í™•ì¸:

<CopyBlock language="python" title="TTL í™•ì¸">
import redis

r = redis.Redis(host='localhost', port=6379, db=0)

r.set('mykey', 'value', ex=3600)
ttl = r.ttl('mykey')
print(f'ë‚¨ì€ ì‹œê°„: {ttl}ì´ˆ')
</CopyBlock>

<Callout type="warning">
âš ï¸ **ì£¼ì˜**: ìºì‹œ ë©”ëª¨ë¦¬ê°€ ê°€ë“ ì°¨ë©´ RedisëŠ” ì˜¤ë˜ëœ ë°ì´í„°ë¥¼ ìë™ìœ¼ë¡œ ì œê±°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¤‘ìš”í•œ ë°ì´í„°ëŠ” TTLì„ ì ì ˆíˆ ì„¤ì •í•˜ì„¸ìš”.
</Callout>

<Screenshot
  src="https://res.cloudinary.com/demo/image/upload/v1/redis/step5-advanced-caching-ko.png"
  alt="ê³ ê¸‰ ìºì‹±"
  caption="ìºì‹œ ë¬´íš¨í™”, ì›Œë°, TTL ëª¨ë‹ˆí„°ë§ìœ¼ë¡œ ìºì‹œë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ê´€ë¦¬í•©ë‹ˆë‹¤"
/>

</Step>

---

## ì‹¤ì „ íŒ

### Redis ëª¨ë‹ˆí„°ë§

ì‹¤ì‹œê°„ìœ¼ë¡œ Redis ëª…ë ¹ì–´ë¥¼ ëª¨ë‹ˆí„°ë§:

<CopyBlock language="bash" title="Redis ëª¨ë‹ˆí„°">
redis-cli monitor
</CopyBlock>

### ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í™•ì¸

<CopyBlock language="bash" title="ë©”ëª¨ë¦¬ ì •ë³´">
redis-cli info memory
</CopyBlock>

### ìºì‹œ í†µê³„ ìˆ˜ì§‘

<CopyBlock language="python" title="ìºì‹œ íˆíŠ¸ìœ¨ ì¶”ì ">
import redis

r = redis.Redis(host='localhost', port=6379, db=0)

stats = r.info('stats')
print(f"ì „ì²´ ëª…ë ¹ì–´: {stats['total_commands_processed']}")
print(f"ì ‘ì† ìˆ˜: {stats['total_connections_received']}")
</CopyBlock>

<Callout type="success">
âœ… **ì™„ë£Œ!** Redisë¡œ ìºì‹±ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì„±ëŠ¥ì„ í¬ê²Œ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
</Callout>

---

## ë¬¸ì œ í•´ê²°

### "Connection refused" ì˜¤ë¥˜

Redis ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸:

<CopyBlock language="bash" title="Redis ì—°ê²° í™•ì¸">
redis-cli ping
</CopyBlock>

### ë©”ëª¨ë¦¬ ë¶€ì¡± ì˜¤ë¥˜

Redis ë©”ëª¨ë¦¬ ì •ì±… í™•ì¸ ë° ì¡°ì •:

<CopyBlock language="bash" title="ë©”ëª¨ë¦¬ ì •ì±… ì„¤ì •">
redis-cli CONFIG GET maxmemory-policy
</CopyBlock>

### ëŠë¦° ì‘ë‹µ ì‹œê°„

1. ë„¤íŠ¸ì›Œí¬ ì—°ê²° í™•ì¸
2. Redis ì„œë²„ ë¶€í•˜ í™•ì¸: `redis-cli info stats`
3. í‚¤ ê°œìˆ˜ í™•ì¸: `redis-cli dbsize`
